# Web.Casa æ–¹æ¡ˆè®¾è®¡ç¨¿

> ç‰ˆæœ¬: 1.0 | æ—¥æœŸ: 2026-02-28

---

## 1. æ€»ä½“æ¶æ„

### 1.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Browser / IDE (MCP)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS / WSS
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Web.Casa Panel (:39921)                      â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Gin HTTP Server                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ æ ¸å¿ƒè·¯ç”±  â”‚  â”‚ æ’ä»¶è·¯ç”±æ³¨å†Œ  â”‚  â”‚ WebSocket (ç»ˆç«¯/æ—¥å¿—)â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ /api/*   â”‚  â”‚/api/plugins/*â”‚  â”‚ /ws/*               â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚       â”‚               â”‚                      â”‚             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚              ç»Ÿä¸€ä¸­é—´ä»¶å±‚                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  JWT Auth â”‚ RBAC â”‚ Rate Limit â”‚ Audit â”‚ CORS         â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Plugin Manager                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ç”Ÿå‘½å‘¨æœŸ  â”‚ â”‚ ä¾èµ–è§£æ  â”‚ â”‚ äº‹ä»¶æ€»çº¿  â”‚ â”‚ å‰ç«¯èµ„æºç®¡ç† â”‚  â”‚  â”‚
â”‚  â”‚  â”‚ Manager  â”‚ â”‚ Resolver â”‚ â”‚ EventBus â”‚ â”‚ AssetServer  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Core      â”‚     Plugins (Go)      â”‚    External Procs    â”‚  â”‚
â”‚  â”‚             â”‚                       â”‚                      â”‚  â”‚
â”‚  â”‚ HostService â”‚ plugin-docker         â”‚ Caddy Server         â”‚  â”‚
â”‚  â”‚ CaddyMgr   â”‚ plugin-project-deploy â”‚ Docker Daemon        â”‚  â”‚
â”‚  â”‚ UserService â”‚ plugin-ai-assistant   â”‚ Kopia Agent          â”‚  â”‚
â”‚  â”‚ AuditSvc   â”‚ plugin-database       â”‚ Node.js Apps         â”‚  â”‚
â”‚  â”‚ ...        â”‚ plugin-filemanager    â”‚ Go Apps              â”‚  â”‚
â”‚  â”‚             â”‚ plugin-backup         â”‚ PHP-FPM              â”‚  â”‚
â”‚  â”‚             â”‚ plugin-monitor        â”‚                      â”‚  â”‚
â”‚  â”‚             â”‚ plugin-app-store      â”‚                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  SQLite (WAL Mode)                           â”‚  â”‚
â”‚  â”‚  core tables â”‚ plugin_{name}_* tables â”‚ settings KV          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 å…³é”®è®¾è®¡å†³ç­–

| å†³ç­– | é€‰æ‹© | ç†ç”± |
|------|------|------|
| æ’ä»¶æœºåˆ¶ | Go Interface + å†…ç½®ç¼–è¯‘ (é .so) | Go plugin è·¨ç‰ˆæœ¬å…¼å®¹å·®ï¼Œæ”¹ç”¨ç¼–è¯‘æ—¶æ³¨å†Œæ¨¡å¼ |
| å‰ç«¯æ’ä»¶åŠ è½½ | åŠ¨æ€ import() + çº¦å®šå¼è·¯ç”± | é¿å… Module Federation çš„å¤æ‚æ€§ |
| è¿›ç¨‹é—´é€šä¿¡ | å†…è¿›ç¨‹è°ƒç”¨ (åŒä¸€ Go binary) | 2GB å†…å­˜çº¦æŸï¼Œä¸é¢å¤–å¯è¿›ç¨‹ |
| äº‹ä»¶ç³»ç»Ÿ | å†…å­˜ EventBus (pub/sub) | å•æœºåœºæ™¯ï¼Œæ— éœ€ Redis/NATS |
| æ„å»ºéš”ç¦» | Linux namespace / cgroup (å¯é€‰ Docker) | å®‰å…¨æ‰§è¡Œç”¨æˆ·ä»£ç  |
| AI æ¥å…¥ | é€šç”¨ OpenAI-compatible API | å…¼å®¹æ‰€æœ‰ä¸»æµ LLM Provider |

---

## 2. æ’ä»¶ç³»ç»Ÿè®¾è®¡

### 2.1 æ’ä»¶æ¥å£å®šä¹‰ (Go)

```go
// internal/plugin/types.go

package plugin

import (
    "github.com/gin-gonic/gin"
    "gorm.io/gorm"
)

// Plugin æ˜¯æ‰€æœ‰æ’ä»¶å¿…é¡»å®ç°çš„æ¥å£
type Plugin interface {
    // å…ƒæ•°æ®
    Metadata() Metadata

    // ç”Ÿå‘½å‘¨æœŸ
    Init(ctx *PluginContext) error    // åˆå§‹åŒ–(æ³¨å†Œè·¯ç”±ã€è¿ç§»æ•°æ®åº“)
    Start() error                     // å¯åŠ¨åå°ä»»åŠ¡
    Stop() error                      // åœæ­¢
    Uninstall() error                 // å¸è½½æ¸…ç†
}

// Metadata æ’ä»¶å…ƒæ•°æ®
type Metadata struct {
    ID           string            // å”¯ä¸€æ ‡è¯†: "docker", "ai-assistant"
    Name         string            // æ˜¾ç¤ºåç§°: "Docker ç®¡ç†"
    Version      string            // è¯­ä¹‰ç‰ˆæœ¬: "1.0.0"
    Description  string            // æè¿°
    Author       string            // ä½œè€…
    Dependencies []string          // ä¾èµ–çš„å…¶ä»–æ’ä»¶ ID
    Priority     int               // åŠ è½½ä¼˜å…ˆçº§ (è¶Šå°è¶Šå…ˆ)
    Icon         string            // å›¾æ ‡åç§° (Lucide icon name)
    Category     string            // åˆ†ç±»: "deploy", "database", "tool"
}

// PluginContext æ’ä»¶è¿è¡Œä¸Šä¸‹æ–‡
type PluginContext struct {
    DB          *gorm.DB           // æ•°æ®åº“è¿æ¥ (æ’ä»¶ç”¨ç‹¬ç«‹è¡¨å‰ç¼€)
    Router      *gin.RouterGroup   // API è·¯ç”±ç»„ /api/plugins/{id}/
    EventBus    *EventBus          // äº‹ä»¶æ€»çº¿
    Logger      *slog.Logger       // æ—¥å¿—å™¨
    DataDir     string             // æ’ä»¶æ•°æ®ç›®å½•
    ConfigStore ConfigStore        // æ’ä»¶é…ç½®è¯»å†™
    CoreAPI     CoreAPI            // æ ¸å¿ƒåŠŸèƒ½ API (å¦‚æ·»åŠ åä»£)
}

// CoreAPI æ’ä»¶å¯è°ƒç”¨çš„æ ¸å¿ƒåŠŸèƒ½
type CoreAPI interface {
    // Host ç®¡ç†
    CreateHost(req CreateHostRequest) (*Host, error)
    UpdateHost(id uint, req UpdateHostRequest) error
    DeleteHost(id uint) error
    ReloadCaddy() error

    // ç”¨æˆ·ä¿¡æ¯
    GetCurrentUser(c *gin.Context) (*User, error)

    // è®¾ç½®
    GetSetting(key string) (string, error)
    SetSetting(key, value string) error
}
```

### 2.2 æ’ä»¶ç®¡ç†å™¨

```go
// internal/plugin/manager.go

type Manager struct {
    plugins    map[string]Plugin        // å·²æ³¨å†Œæ’ä»¶
    order      []string                 // æŒ‰ä¾èµ–æ‹“æ‰‘æ’åºçš„åŠ è½½é¡ºåº
    eventBus   *EventBus
    db         *gorm.DB
    router     *gin.Engine
    dataDir    string
}

// æ’ä»¶æ³¨å†Œ (ç¼–è¯‘æ—¶)
func (m *Manager) Register(p Plugin) error

// åˆå§‹åŒ–æ‰€æœ‰æ’ä»¶ (ä¾èµ–æ’åº)
func (m *Manager) InitAll() error

// å¯åŠ¨/åœæ­¢
func (m *Manager) StartAll() error
func (m *Manager) StopAll() error

// æŒ‰ ID è·å–æ’ä»¶
func (m *Manager) Get(id string) (Plugin, bool)

// åˆ—å‡ºå·²å®‰è£…æ’ä»¶
func (m *Manager) List() []PluginInfo

// å¯ç”¨/ç¦ç”¨å•ä¸ªæ’ä»¶
func (m *Manager) Enable(id string) error
func (m *Manager) Disable(id string) error
```

### 2.3 äº‹ä»¶æ€»çº¿

```go
// internal/plugin/eventbus.go

type Event struct {
    Type    string                 // "host.created", "deploy.failed", "docker.started"
    Payload map[string]interface{}
    Source  string                 // æ¥æºæ’ä»¶ ID
    Time    time.Time
}

type EventHandler func(event Event) error

type EventBus struct {
    handlers map[string][]EventHandler
    mu       sync.RWMutex
}

func (eb *EventBus) Subscribe(eventType string, handler EventHandler)
func (eb *EventBus) Publish(event Event) error
```

### 2.4 å‰ç«¯æ’ä»¶æœºåˆ¶

æ’ä»¶çš„å‰ç«¯é‡‡ç”¨**çº¦å®šå¼ç›®å½•ç»“æ„**ï¼Œæ„å»ºåç”Ÿæˆæ ‡å‡† JS bundle:

```
plugin-docker/
  web/
    src/
      pages/
        DockerOverview.jsx     â†’ ä¾§è¾¹æ ä¸»é¡µé¢
        DockerContainers.jsx   â†’ å­é¡µé¢
        DockerImages.jsx       â†’ å­é¡µé¢
      manifest.json            â†’ å‰ç«¯è·¯ç”±+èœå•å£°æ˜
```

**manifest.json:**
```json
{
  "id": "docker",
  "routes": [
    { "path": "/docker", "component": "DockerOverview", "menu": true, "icon": "Container", "label": "Docker" },
    { "path": "/docker/containers", "component": "DockerContainers" },
    { "path": "/docker/images", "component": "DockerImages" }
  ],
  "menuGroup": "deploy",
  "menuOrder": 20
}
```

**æ ¸å¿ƒå‰ç«¯åŠ è½½æœºåˆ¶:**
```jsx
// web/src/plugins/PluginLoader.jsx

// æ ¸å¿ƒåº”ç”¨æ‰«æ /api/plugins/frontend-manifests è·å–æ‰€æœ‰å¯ç”¨æ’ä»¶çš„è·¯ç”±
// åŠ¨æ€æ³¨å†Œåˆ° React Router

function loadPluginRoutes() {
  const manifests = await fetch('/api/plugins/frontend-manifests');
  return manifests.flatMap(m =>
    m.routes.map(r => ({
      path: r.path,
      element: React.lazy(() => import(`/api/plugins/${m.id}/assets/${r.component}.js`))
    }))
  );
}
```

### 2.5 æ’ä»¶æ•°æ®éš”ç¦»

```
æ•°æ®åº“è¡¨å‘½å: plugin_{id}_{table}
  ä¾‹: plugin_docker_containers
      plugin_docker_images
      plugin_backup_schedules
      plugin_ai_conversations

æ•°æ®ç›®å½•: {DATA_DIR}/plugins/{id}/
  ä¾‹: data/plugins/docker/
      data/plugins/backup/
      data/plugins/ai-assistant/

é…ç½®å­˜å‚¨: settings è¡¨, key = "plugin.{id}.{key}"
  ä¾‹: plugin.ai-assistant.llm_base_url
      plugin.docker.socket_path
```

---

## 3. æ ¸å¿ƒæ’ä»¶è®¾è®¡

### 3.1 plugin-project-deploy (é¡¹ç›®éƒ¨ç½²)

```
æ ¸å¿ƒåŠŸèƒ½:
  â”œâ”€â”€ Git å…‹éš† (æ”¯æŒ GitHub/GitLab/Gitea + Deploy Key)
  â”œâ”€â”€ æ¡†æ¶è‡ªåŠ¨æ£€æµ‹ (package.json/go.mod/composer.json)
  â”œâ”€â”€ æ„å»ºæµç¨‹ç¼–æ’
  â”‚     â”œâ”€â”€ Node.js: npm install â†’ npm run build â†’ pm2/node start
  â”‚     â”œâ”€â”€ Go: go build â†’ supervisord/systemd
  â”‚     â”œâ”€â”€ PHP: composer install â†’ php-fpm
  â”‚     â””â”€â”€ è‡ªå®šä¹‰: Dockerfile / è„šæœ¬
  â”œâ”€â”€ è¿›ç¨‹ç®¡ç† (å¯åŠ¨/åœæ­¢/é‡å¯/æ—¥å¿—)
  â”œâ”€â”€ ç¯å¢ƒå˜é‡ç®¡ç† (.env)
  â”œâ”€â”€ è‡ªåŠ¨åä»£é…ç½® (è°ƒç”¨ CoreAPI)
  â”œâ”€â”€ Webhook è§¦å‘è‡ªåŠ¨é‡æ–°éƒ¨ç½²
  â””â”€â”€ å›æ»š (ä¿ç•™æœ€è¿‘ N ä¸ªç‰ˆæœ¬)

æ•°æ®æ¨¡å‹:
  plugin_deploy_projects
    â”œâ”€â”€ id, name, domain
    â”œâ”€â”€ git_url, git_branch, deploy_key
    â”œâ”€â”€ framework (nextjs/nuxt/laravel/gin/custom)
    â”œâ”€â”€ build_command, start_command
    â”œâ”€â”€ env_vars (JSON, åŠ å¯†)
    â”œâ”€â”€ port, status (building/running/stopped/error)
    â”œâ”€â”€ current_version, versions (JSON)
    â””â”€â”€ auto_deploy (webhook)

API:
  POST   /api/plugins/deploy/projects          â€” åˆ›å»ºé¡¹ç›®
  GET    /api/plugins/deploy/projects           â€” åˆ—å‡ºé¡¹ç›®
  GET    /api/plugins/deploy/projects/:id       â€” é¡¹ç›®è¯¦æƒ…
  PUT    /api/plugins/deploy/projects/:id       â€” æ›´æ–°é¡¹ç›®
  DELETE /api/plugins/deploy/projects/:id       â€” åˆ é™¤é¡¹ç›®
  POST   /api/plugins/deploy/projects/:id/build â€” è§¦å‘æ„å»º
  POST   /api/plugins/deploy/projects/:id/start â€” å¯åŠ¨
  POST   /api/plugins/deploy/projects/:id/stop  â€” åœæ­¢
  POST   /api/plugins/deploy/projects/:id/rollback â€” å›æ»š
  GET    /api/plugins/deploy/projects/:id/logs  â€” æ„å»º/è¿è¡Œæ—¥å¿—
  POST   /api/plugins/deploy/webhook/:token     â€” Git Webhook
  GET    /api/plugins/deploy/detect             â€” æ£€æµ‹æ¡†æ¶ç±»å‹
```

### 3.2 plugin-docker (Docker ç®¡ç†)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Docker Plugin                   â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         ç®€å•æ¨¡å¼ (é»˜è®¤)              â”‚    â”‚
â”‚  â”‚  åº”ç”¨/Stack åˆ—è¡¨                     â”‚    â”‚
â”‚  â”‚  ä¸€é”®: éƒ¨ç½² / é‡å¯ / æ›´æ–° / å›æ»š    â”‚    â”‚
â”‚  â”‚        å¤‡ä»½ / æ—¥å¿—                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         é«˜çº§æ¨¡å¼                     â”‚    â”‚
â”‚  â”‚  å®¹å™¨ â”‚ é•œåƒ â”‚ ç½‘ç»œ â”‚ å· â”‚ Compose  â”‚    â”‚
â”‚  â”‚  èµ„æºé™åˆ¶ â”‚ å¥åº·æ£€æŸ¥ â”‚ æ—¥å¿—          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     Docker Socket é€šä¿¡å±‚             â”‚    â”‚
â”‚  â”‚  /var/run/docker.sock               â”‚    â”‚
â”‚  â”‚  Docker API v1.43+                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

API:
  # Stack (ç®€å•æ¨¡å¼)
  GET    /api/plugins/docker/stacks             â€” åˆ—å‡º Stack
  POST   /api/plugins/docker/stacks             â€” åˆ›å»º Stack (ä» Compose)
  POST   /api/plugins/docker/stacks/:id/up      â€” å¯åŠ¨
  POST   /api/plugins/docker/stacks/:id/down    â€” åœæ­¢
  POST   /api/plugins/docker/stacks/:id/restart â€” é‡å¯
  POST   /api/plugins/docker/stacks/:id/pull    â€” æ‹‰å–æ›´æ–°
  GET    /api/plugins/docker/stacks/:id/logs    â€” æ—¥å¿—

  # å®¹å™¨ (é«˜çº§æ¨¡å¼)
  GET    /api/plugins/docker/containers         â€” åˆ—å‡ºå®¹å™¨
  POST   /api/plugins/docker/containers/:id/start
  POST   /api/plugins/docker/containers/:id/stop
  POST   /api/plugins/docker/containers/:id/restart
  DELETE /api/plugins/docker/containers/:id
  GET    /api/plugins/docker/containers/:id/logs
  GET    /api/plugins/docker/containers/:id/stats â€” å®æ—¶èµ„æº

  # é•œåƒ/ç½‘ç»œ/å·
  GET    /api/plugins/docker/images
  DELETE /api/plugins/docker/images/:id
  GET    /api/plugins/docker/networks
  GET    /api/plugins/docker/volumes
```

### 3.3 plugin-ai-assistant (AI åŠ©æ‰‹)

```
æ¶æ„:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚       AI Assistant Plugin     â”‚
  â”‚                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚    Chat Interface      â”‚  â”‚  â† é¢æ¿å³ä¸‹è§’æµ®åŠ¨å¯¹è¯æ¡†
  â”‚  â”‚  (Streaming SSE)       â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚              â”‚               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚   Context Collector    â”‚  â”‚  â† è‡ªåŠ¨æ”¶é›†ç›¸å…³ä¸Šä¸‹æ–‡
  â”‚  â”‚  - å½“å‰é¡µé¢ä¸Šä¸‹æ–‡       â”‚  â”‚
  â”‚  â”‚  - æœ€è¿‘é”™è¯¯æ—¥å¿—         â”‚  â”‚
  â”‚  â”‚  - é¡¹ç›®é…ç½®ä¿¡æ¯         â”‚  â”‚
  â”‚  â”‚  - ç³»ç»ŸçŠ¶æ€             â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚              â”‚               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚   LLM Client          â”‚  â”‚  â† OpenAI-compatible API
  â”‚  â”‚  (Streaming)           â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ ¸å¿ƒåŠŸèƒ½:
  1. æ™ºèƒ½å¯¹è¯ â€” æµå¼è¾“å‡ºï¼ŒMarkdown æ¸²æŸ“
  2. é”™è¯¯è¯Šæ–­ â€” è‡ªåŠ¨æ³¨å…¥æ—¥å¿—ä¸Šä¸‹æ–‡ï¼Œåˆ†æéƒ¨ç½²é”™è¯¯
  3. Text-to-Template â€” è‡ªç„¶è¯­è¨€ â†’ Docker Compose YAML
  4. é…ç½®å»ºè®® â€” åˆ†æé¡¹ç›®ç±»å‹ï¼Œæ¨èæœ€ä¼˜é…ç½®
  5. æ¯æ­¥å‘å¯¼æ—ã€Œé—® AIã€â€” è§£é‡Šå­—æ®µå«ä¹‰å’Œæœ€ä½³å®è·µ

API:
  POST   /api/plugins/ai/chat           â€” å‘é€æ¶ˆæ¯ (SSE æµå¼å“åº”)
  GET    /api/plugins/ai/conversations   â€” å¯¹è¯å†å²
  DELETE /api/plugins/ai/conversations/:id
  POST   /api/plugins/ai/generate-compose â€” Text-to-Template
  POST   /api/plugins/ai/diagnose        â€” è‡ªåŠ¨è¯Šæ–­ (ä¼ å…¥æ—¥å¿—)
  GET    /api/plugins/ai/config          â€” AI é…ç½®
  PUT    /api/plugins/ai/config          â€” æ›´æ–° AI é…ç½®
```

### 3.4 plugin-database (æ•°æ®åº“ç®¡ç†)

```
æ”¯æŒçš„æ•°æ®åº“ (å‡é€šè¿‡ Docker è¿è¡Œ):
  â”œâ”€â”€ MySQL 8.x
  â”œâ”€â”€ MariaDB 11.x
  â”œâ”€â”€ PostgreSQL 16.x
  â”œâ”€â”€ Redis 7.x
  â”œâ”€â”€ SQLite (æœ¬åœ°æ–‡ä»¶)
  â””â”€â”€ Turso (LibSQL, é€šè¿‡ Docker æˆ–è¿œç¨‹è¿æ¥)

åŠŸèƒ½:
  â”œâ”€â”€ ä¸€é”®åˆ›å»ºæ•°æ®åº“å®ä¾‹ (Docker å®¹å™¨)
  â”œâ”€â”€ åˆ›å»ºæ•°æ®åº“/ç”¨æˆ·/æƒé™
  â”œâ”€â”€ å¤‡ä»½/æ¢å¤ (é›†æˆ plugin-backup)
  â”œâ”€â”€ è¿æ¥ä¿¡æ¯å±•ç¤º (è¿æ¥å­—ç¬¦ä¸²ã€ç«¯å£)
  â”œâ”€â”€ åŸºç¡€æŸ¥è¯¢ç•Œé¢ (å¯é€‰ï¼Œè½»é‡çº§)
  â””â”€â”€ ç›‘æ§ (è¿æ¥æ•°ã€å†…å­˜ã€æ…¢æŸ¥è¯¢)

ä¾èµ–: plugin-docker (é€šè¿‡ Docker è¿è¡Œæ•°æ®åº“å®ä¾‹)
```

### 3.5 plugin-filemanager (æ–‡ä»¶ç®¡ç†å™¨ + ç»ˆç«¯)

```
æ–‡ä»¶ç®¡ç†å™¨:
  â”œâ”€â”€ ç›®å½•æµè§ˆ (æ ‘å½¢ + åˆ—è¡¨)
  â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ (æ‹–æ‹½ä¸Šä¼ ï¼Œåˆ†ç‰‡ä¸Šä¼ )
  â”œâ”€â”€ åœ¨çº¿ç¼–è¾‘ (CodeMirror, è¯­æ³•é«˜äº®)
  â”œâ”€â”€ æ–‡ä»¶æœç´¢
  â”œâ”€â”€ æƒé™ä¿®æ”¹ (chmod/chown)
  â””â”€â”€ å‹ç¼©/è§£å‹

Web ç»ˆç«¯:
  â”œâ”€â”€ xterm.js + WebSocket
  â”œâ”€â”€ å¤šæ ‡ç­¾é¡µ
  â”œâ”€â”€ ç»ˆç«¯å¤§å°è‡ªé€‚åº”
  â””â”€â”€ å®‰å…¨: ä»…é™ç®¡ç†å‘˜è®¿é—®

API:
  GET    /api/plugins/files/list?path=       â€” åˆ—å‡ºç›®å½•
  GET    /api/plugins/files/read?path=       â€” è¯»å–æ–‡ä»¶
  POST   /api/plugins/files/write            â€” å†™å…¥æ–‡ä»¶
  POST   /api/plugins/files/upload           â€” ä¸Šä¼ æ–‡ä»¶
  GET    /api/plugins/files/download?path=   â€” ä¸‹è½½æ–‡ä»¶
  POST   /api/plugins/files/mkdir            â€” åˆ›å»ºç›®å½•
  DELETE /api/plugins/files/delete           â€” åˆ é™¤
  POST   /api/plugins/files/rename           â€” é‡å‘½å/ç§»åŠ¨
  POST   /api/plugins/files/compress         â€” å‹ç¼©
  POST   /api/plugins/files/extract          â€” è§£å‹
  WS     /ws/plugins/files/terminal          â€” WebSocket ç»ˆç«¯
```

### 3.6 plugin-backup (å¤‡ä»½)

```
åŸºäº Kopia:
  â”œâ”€â”€ ç›®æ ‡: S3 / WebDAV / æœ¬åœ°ç›®å½• / SFTP
  â”œâ”€â”€ å¢é‡å¤‡ä»½ (Kopia åŸç”Ÿæ”¯æŒ)
  â”œâ”€â”€ å®šæ—¶ç­–ç•¥ (æ¯æ—¥/æ¯å‘¨/æ¯æœˆ)
  â”œâ”€â”€ ä¿ç•™ç­–ç•¥ (ä¿ç•™ N ä»½/ä¿ç•™ N å¤©)
  â”œâ”€â”€ å¤‡ä»½èŒƒå›´:
  â”‚     â”œâ”€â”€ é¢æ¿æ•°æ® (SQLite DB + é…ç½®)
  â”‚     â”œâ”€â”€ é¡¹ç›®æºç  + æ•°æ®
  â”‚     â”œâ”€â”€ Docker å·
  â”‚     â””â”€â”€ æ•°æ®åº“ dump
  â””â”€â”€ ä¸€é”®æ¢å¤
```

### 3.7 plugin-monitor (ç³»ç»Ÿç›‘æ§)

```
é‡‡é›†æŒ‡æ ‡:
  â”œâ”€â”€ CPU ä½¿ç”¨ç‡ (æ€»ä½“ + æ¯æ ¸)
  â”œâ”€â”€ å†…å­˜ä½¿ç”¨ (total/used/available/swap)
  â”œâ”€â”€ ç£ç›˜ I/O + ä½¿ç”¨ç‡
  â”œâ”€â”€ ç½‘ç»œæµé‡ (in/out per interface)
  â”œâ”€â”€ ç³»ç»Ÿè´Ÿè½½ (1/5/15min)
  â””â”€â”€ Docker å®¹å™¨èµ„æº (CPU/MEM per container)

å­˜å‚¨: SQLite è¡¨, æŒ‰åˆ†é’Ÿèšåˆ, è‡ªåŠ¨æ¸…ç† 30 å¤©ä»¥ä¸Šæ•°æ®
å±•ç¤º: å®æ—¶ä»ªè¡¨ç›˜ + å†å²å›¾è¡¨ (Recharts)
å‘Šè­¦: é˜ˆå€¼è§¦å‘ â†’ Webhook / Email é€šçŸ¥
```

### 3.8 plugin-app-store (åº”ç”¨å•†åº—)

```
å…¼å®¹ Runtipi appstore æ ¼å¼:
  app-id/
    â”œâ”€â”€ config.json        â€” åº”ç”¨å…ƒæ•°æ®
    â”œâ”€â”€ docker-compose.yml â€” Compose å®šä¹‰
    â”œâ”€â”€ description.md     â€” åº”ç”¨æè¿°
    â””â”€â”€ logo.png          â€” åº”ç”¨å›¾æ ‡

åŠŸèƒ½:
  â”œâ”€â”€ æµè§ˆåº”ç”¨åˆ—è¡¨ (åˆ†ç±»ã€æœç´¢)
  â”œâ”€â”€ ä¸€é”®å®‰è£… (å¡«å‚æ•° â†’ ç”Ÿæˆ compose â†’ å¯åŠ¨)
  â”œâ”€â”€ åº”ç”¨æ›´æ–°
  â”œâ”€â”€ è‡ªåŠ¨åä»£é…ç½®
  â””â”€â”€ AI ç”Ÿæˆè‡ªå®šä¹‰æ¨¡æ¿ (Text-to-Template)

æ•°æ®æº:
  â”œâ”€â”€ å†…ç½®ç²¾é€‰åº”ç”¨
  â”œâ”€â”€ å…¼å®¹ runtipi-appstore ä»“åº“
  â””â”€â”€ ç”¨æˆ·è‡ªå®šä¹‰åº”ç”¨æº
```

---

## 4. æ–°æ‰‹å‹å¥½ä½“éªŒè®¾è®¡

### 4.1 åˆ›å»ºé¡¹ç›®å‘å¯¼

```
æ­¥éª¤ 1/4: é€‰æ‹©è¯­è¨€/æ¡†æ¶          [é—® AI ğŸ’¬]
  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
  â”‚Node.jsâ”‚ â”‚ PHP  â”‚ â”‚  Go  â”‚ â”‚Dockerâ”‚
  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
  æ¨èæ¡†æ¶: Next.js | Nuxt | Express | ...

æ­¥éª¤ 2/4: é€‰æ‹©éƒ¨ç½²æ–¹å¼            [é—® AI ğŸ’¬]
  â—‹ ä» Git ä»“åº“éƒ¨ç½² (æ¨è)
  â—‹ ä¸Šä¼ æºç 
  â—‹ Docker é•œåƒ
  â—‹ ä»æ¨¡æ¿åˆ›å»º

æ­¥éª¤ 3/4: é…ç½®åŸŸåå’Œç«¯å£          [é—® AI ğŸ’¬]
  åŸŸå: [app.example.com    ]
  ç«¯å£: [3000               ] (è‡ªåŠ¨æ£€æµ‹)

æ­¥éª¤ 4/4: å¯é€‰å¢å¼º                [é—® AI ğŸ’¬]
  â˜‘ å¯ç”¨ HTTPS (Let's Encrypt)
  â˜ å¯ç”¨è‡ªåŠ¨å¤‡ä»½
  â˜ å¯ç”¨ç³»ç»Ÿç›‘æ§
  â˜ é…ç½®æ•°æ®åº“
```

### 4.2 æ–°æ‰‹æ¨¡å¼ vs é«˜çº§æ¨¡å¼

```
å…¨å±€åˆ‡æ¢: è®¾ç½® â†’ ç•Œé¢æ¨¡å¼ â†’ æ–°æ‰‹/é«˜çº§

æ–°æ‰‹æ¨¡å¼:
  - åªæ˜¾ç¤ºå¿…è¦å­—æ®µ
  - å¤§é‡é»˜è®¤å€¼ (è‡ªåŠ¨æ£€æµ‹æœ€ä¼˜é…ç½®)
  - æ¯ä¸ªå…³é”®æ“ä½œæ—æœ‰è¯´æ˜æ–‡å­—
  - æ“ä½œç¡®è®¤å¼¹çª— (é˜²æ­¢è¯¯æ“ä½œ)
  - éƒ¨ç½²å¤±è´¥è‡ªåŠ¨å¼¹å‡º AI è¯Šæ–­

é«˜çº§æ¨¡å¼:
  - æ˜¾ç¤ºå…¨éƒ¨é…ç½®é¡¹
  - å¯ç¼–è¾‘åŸå§‹ YAML/Caddyfile
  - æ˜¾ç¤º Docker åº•å±‚ä¿¡æ¯
  - æ˜¾ç¤ºå®Œæ•´æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯
```

---

## 5. ç›®å½•ç»“æ„è§„åˆ’ (æ‰©å±•å)

```
caddypanel/
â”œâ”€â”€ main.go                          # å…¥å£ + æ’ä»¶æ³¨å†Œ
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/                      # é…ç½®
â”‚   â”œâ”€â”€ database/                    # æ•°æ®åº“
â”‚   â”œâ”€â”€ model/                       # æ ¸å¿ƒæ¨¡å‹
â”‚   â”œâ”€â”€ auth/                        # è®¤è¯
â”‚   â”œâ”€â”€ handler/                     # æ ¸å¿ƒ API handler
â”‚   â”œâ”€â”€ service/                     # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ caddy/                       # Caddy ç®¡ç†
â”‚   â””â”€â”€ plugin/                      # â† æ–°å¢: æ’ä»¶æ¡†æ¶
â”‚       â”œâ”€â”€ types.go                 #   æ’ä»¶æ¥å£å®šä¹‰
â”‚       â”œâ”€â”€ manager.go               #   æ’ä»¶ç®¡ç†å™¨
â”‚       â”œâ”€â”€ eventbus.go              #   äº‹ä»¶æ€»çº¿
â”‚       â”œâ”€â”€ registry.go              #   æ’ä»¶æ³¨å†Œè¡¨
â”‚       â””â”€â”€ context.go               #   æ’ä»¶ä¸Šä¸‹æ–‡
â”œâ”€â”€ plugins/                         # â† æ–°å¢: æ’ä»¶å®ç°
â”‚   â”œâ”€â”€ docker/
â”‚   â”‚   â”œâ”€â”€ plugin.go                #   Plugin æ¥å£å®ç°
â”‚   â”‚   â”œâ”€â”€ handler.go               #   API handlers
â”‚   â”‚   â”œâ”€â”€ service.go               #   ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ model.go                 #   æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ web/                     #   å‰ç«¯èµ„æº
â”‚   â”œâ”€â”€ deploy/
â”‚   â”œâ”€â”€ ai-assistant/
â”‚   â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ filemanager/
â”‚   â”œâ”€â”€ backup/
â”‚   â”œâ”€â”€ monitor/
â”‚   â””â”€â”€ app-store/
â”œâ”€â”€ web/                             # æ ¸å¿ƒå‰ç«¯
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ plugins/                 # â† æ–°å¢: æ’ä»¶åŠ è½½å™¨
â”‚       â”‚   â”œâ”€â”€ PluginLoader.jsx
â”‚       â”‚   â”œâ”€â”€ PluginRouter.jsx
â”‚       â”‚   â””â”€â”€ PluginSidebar.jsx
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â””â”€â”€ AIChatWidget.jsx     # â† æ–°å¢: AI æµ®åŠ¨å¯¹è¯æ¡†
â”‚       â””â”€â”€ ...
â””â”€â”€ docs/
    â”œâ”€â”€ 01-requirements-analysis.md
    â”œâ”€â”€ 02-architecture-design.md
    â””â”€â”€ 03-development-tasks.md
```

---

## 6. æ•°æ®æµè®¾è®¡

### 6.1 é¡¹ç›®éƒ¨ç½²æµç¨‹

```
ç”¨æˆ·/AI â”€â”€â†’ POST /api/plugins/deploy/projects
               â”‚
               â–¼
         åˆ›å»º Project è®°å½• (status=pending)
               â”‚
               â–¼
         è§¦å‘ Event: "deploy.started"
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Build Pipeline     â”‚
    â”‚  1. git clone         â”‚
    â”‚  2. æ£€æµ‹æ¡†æ¶           â”‚  â† è‡ªåŠ¨è¯†åˆ« package.json / go.mod
    â”‚  3. npm install        â”‚
    â”‚  4. npm run build      â”‚  â† å®æ—¶è¾“å‡ºæ—¥å¿—åˆ° WebSocket
    â”‚  5. å¯åŠ¨è¿›ç¨‹           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
          æˆåŠŸ â”‚ å¤±è´¥
          â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
          â–¼         â–¼
     status=      status=error
     running      è§¦å‘ Event: "deploy.failed"
          â”‚              â”‚
          â–¼              â–¼
     CoreAPI:       AI è‡ªåŠ¨è¯»å–æ—¥å¿—
     CreateHost()   ç”Ÿæˆä¿®å¤å»ºè®®
     (è‡ªåŠ¨åä»£)     æ¨é€ç»™ç”¨æˆ·
```

### 6.2 AI Text-to-Template æµç¨‹

```
ç”¨æˆ·: "æˆ‘è¦ä¸€ä¸ªå¸¦ Redis ç¼“å­˜å’Œ Postgres çš„ N8N ç¯å¢ƒ"
               â”‚
               â–¼
    POST /api/plugins/ai/generate-compose
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ„å»º Prompt:           â”‚
    â”‚  System: ä½ æ˜¯ Docker    â”‚
    â”‚  Compose ä¸“å®¶...        â”‚
    â”‚  User: ç”¨æˆ·éœ€æ±‚         â”‚
    â”‚  Context: æœåŠ¡å™¨ä¿¡æ¯     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
         LLM API (Streaming)
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  è§£æå“åº”:              â”‚
    â”‚  - æå– YAML ä»£ç å—     â”‚
    â”‚  - éªŒè¯ Compose è¯­æ³•    â”‚
    â”‚  - å®‰å…¨æ£€æŸ¥ (æ— ç‰¹æƒç­‰)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    è¿”å› Compose YAML + è¯´æ˜
    ç”¨æˆ·ç¡®è®¤ â†’ ä¸€é”®éƒ¨ç½²
```

---

## 7. å®‰å…¨è®¾è®¡

### 7.1 æ’ä»¶å®‰å…¨

```
åŸåˆ™: æ’ä»¶æ˜¯ä¿¡ä»»ä»£ç  (ç¼–è¯‘è¿›äºŒè¿›åˆ¶)ï¼Œä½†é™åˆ¶è¿è¡Œæ—¶èƒ½åŠ›

é™åˆ¶:
  â”œâ”€â”€ æ’ä»¶åªèƒ½æ“ä½œè‡ªå·±çš„æ•°æ®è¡¨ (plugin_{id}_*)
  â”œâ”€â”€ æ’ä»¶åªèƒ½è¯»å†™è‡ªå·±çš„æ•°æ®ç›®å½•
  â”œâ”€â”€ æ’ä»¶ API è·¯ç”±ç»Ÿä¸€ç»è¿‡ JWT é‰´æƒ
  â”œâ”€â”€ æ’ä»¶ä¸èƒ½ç›´æ¥è®¿é—®å…¶ä»–æ’ä»¶çš„æ•°æ®
  â””â”€â”€ æ’ä»¶é€šè¿‡ CoreAPI æ“ä½œæ ¸å¿ƒåŠŸèƒ½ (æœ‰æƒé™æ£€æŸ¥)
```

### 7.2 é¡¹ç›®éƒ¨ç½²å®‰å…¨

```
æ„å»ºç¯å¢ƒ:
  â”œâ”€â”€ ä½¿ç”¨ç‹¬ç«‹ Linux ç”¨æˆ·æ‰§è¡Œæ„å»º
  â”œâ”€â”€ é™åˆ¶ç½‘ç»œè®¿é—® (åªå…è®¸ npm registry / github ç­‰)
  â”œâ”€â”€ é™åˆ¶æ–‡ä»¶ç³»ç»Ÿ (åªèƒ½è®¿é—®é¡¹ç›®ç›®å½•)
  â”œâ”€â”€ èµ„æºé™åˆ¶ (CPU/MEM/æ—¶é—´è¶…æ—¶)
  â””â”€â”€ æ„å»ºäº§ç‰©æ‰«æ (å¯é€‰)

è¿è¡Œç¯å¢ƒ:
  â”œâ”€â”€ æ¯ä¸ªé¡¹ç›®ä¸€ä¸ªç‹¬ç«‹ç³»ç»Ÿç”¨æˆ·
  â”œâ”€â”€ è¿›ç¨‹ä½¿ç”¨ systemd/supervisord ç®¡ç†
  â”œâ”€â”€ ç«¯å£è‡ªåŠ¨åˆ†é… (é¿å…å†²çª)
  â””â”€â”€ ç¯å¢ƒå˜é‡åŠ å¯†å­˜å‚¨
```

### 7.3 AI å®‰å…¨

```
  â”œâ”€â”€ API Key ä½¿ç”¨ AES-GCM åŠ å¯†å­˜å‚¨
  â”œâ”€â”€ AI è¯·æ±‚ä¸åŒ…å«æ•æ„Ÿç¯å¢ƒå˜é‡
  â”œâ”€â”€ AI ç”Ÿæˆçš„ Compose æ–‡ä»¶ç»è¿‡å®‰å…¨æ£€æŸ¥
  â”‚     â”œâ”€â”€ ç¦æ­¢ privileged: true
  â”‚     â”œâ”€â”€ ç¦æ­¢ network_mode: host (é»˜è®¤)
  â”‚     â”œâ”€â”€ ç¦æ­¢æŒ‚è½½ /etc, /var/run/docker.sock ç­‰
  â”‚     â””â”€â”€ è­¦å‘Šè¿‡å¤§çš„èµ„æºè¯·æ±‚
  â””â”€â”€ AI ä¸èƒ½ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œåªèƒ½å»ºè®®
```

---

## 8. æŠ€æœ¯é€‰å‹ç»†èŠ‚

### 8.1 æ–°å¢ä¾èµ–

| ç»„ä»¶ | æŠ€æœ¯ | ç”¨é€” |
|------|------|------|
| Docker å®¢æˆ·ç«¯ | github.com/docker/docker | Docker API é€šä¿¡ |
| WebSocket | gorilla/websocket | ç»ˆç«¯ + å®æ—¶æ—¥å¿— |
| å‰ç«¯ç»ˆç«¯ | xterm.js | Web ç»ˆç«¯æ¨¡æ‹Ÿå™¨ |
| å¤‡ä»½å¼•æ“ | Kopia CLI | å¢é‡å¤‡ä»½ (å¤–éƒ¨è¿›ç¨‹è°ƒç”¨) |
| ç³»ç»Ÿç›‘æ§ | shirou/gopsutil | CPU/MEM/Disk/Net é‡‡é›† |
| è¿›ç¨‹ç®¡ç† | supervisord æˆ– systemd API | ç®¡ç†éƒ¨ç½²çš„åº”ç”¨è¿›ç¨‹ |
| å›¾è¡¨ | Recharts | ç›‘æ§ä»ªè¡¨ç›˜ |
| Markdown | react-markdown | AI å¯¹è¯æ¸²æŸ“ |
| SSE | åŸç”Ÿ Gin | AI æµå¼å“åº” |

### 8.2 å‰ç«¯æ–°å¢é¡µé¢ (Pro)

| é¡µé¢ | å¯¹åº”æ’ä»¶ | æè¿° |
|------|---------|------|
| /plugins | æ ¸å¿ƒ | æ’ä»¶å¸‚åœº + å·²å®‰è£…ç®¡ç† |
| /deploy | plugin-deploy | é¡¹ç›®åˆ—è¡¨ + éƒ¨ç½²å‘å¯¼ |
| /deploy/:id | plugin-deploy | é¡¹ç›®è¯¦æƒ… (æ—¥å¿—/ç¯å¢ƒå˜é‡/ç‰ˆæœ¬) |
| /docker | plugin-docker | Docker æ€»è§ˆ (ç®€å•æ¨¡å¼) |
| /docker/advanced | plugin-docker | é«˜çº§æ¨¡å¼ (å®¹å™¨/é•œåƒ/ç½‘ç»œ/å·) |
| /databases | plugin-database | æ•°æ®åº“å®ä¾‹ç®¡ç† |
| /files | plugin-filemanager | æ–‡ä»¶ç®¡ç†å™¨ |
| /terminal | plugin-filemanager | Web ç»ˆç«¯ |
| /backups | plugin-backup | å¤‡ä»½ä»»åŠ¡ + æ¢å¤ |
| /monitoring | plugin-monitor | ç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜ |
| /app-store | plugin-app-store | åº”ç”¨å•†åº— |
| /templates | plugin-template-market | é¡¹ç›®æ¨¡æ¿å¸‚åœº |
